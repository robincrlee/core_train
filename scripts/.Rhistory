theme(plot.title = element_text(size = 20, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap( body_type ~, nrow = 2, strip.position = "bottom")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據時間、胖瘦而影響',
"輕度運動中瘦的人飯後運動主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 20, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "bottom")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據時間、胖瘦而影響',
"輕度運動中瘦的人飯後運動主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 20, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據時間、胖瘦而影響',
"輕度運動中瘦的人飯後運動主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 20, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據時間、胖瘦而影響',
"輕度運動中瘦的人飯後運動主要使用葡萄糖")+
legend("能量來源")+
theme_tufte()+
theme(plot.title = element_text(size = 20, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據時間、胖瘦而影響',
"輕度運動中瘦的人飯後運動主要使用葡萄糖")+
guide_legend(title = "能量來源")+
theme_tufte()+
theme(plot.title = element_text(size = 20, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據時間、胖瘦而影響',
"輕度運動中瘦的人飯後運動主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"))+
theme_tufte()+
theme(plot.title = element_text(size = 20, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據時間\n、胖瘦而影響',
"輕度運動中瘦的人飯後運動主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"輕度運動中瘦的人飯後運動主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"輕度運動時，瘦的人飯後運動主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"輕度運動時，瘦的人飯後運動主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"))+
scale_color_brewer(palette = "Set1")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"輕度運動時，瘦的人飯後運動主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_color_brewer(palette = "Set1")+
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"輕度運動時，瘦的人飯後運動主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_color_brewer(palette = "Set1")
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('運動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"輕度運動時，瘦的人飯後運動主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_color_brewer(palette = "Set1")
ggplot(df1, aes(time, bp, colour = type))+
geom_point()+
geom_line()+
theme_tufte()+
scale_x_continuous(limits = c(0, 120))+
scale_y_continuous(limits = c(40, 200))+
scale_color_brewer(palette = "Set1")+
xlab('運動時間(秒數)')+
ylab('血壓(mmHg)') +
ggtitle('當一個人運動時間增加時，\n收縮壓會上升，舒張壓會下降',
"這個圖表是模擬的示意圖")+
guides(color=FALSE)+
annotate('text', x=60, y=170, label = '收縮壓', size = 6, family = "STHeiti")  +
annotate('text', x=60, y=90, label = '舒張壓', size = 6, family = "STHeiti") +
theme(plot.title = element_text(size = 20, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_fill_brewer(palette = "Set1")
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"), palette = palette("Set1"))
?scale_fill_discrete
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"), palette = "Set1")
Sys.setlocale(category = "LC_ALL", locale = "zh_TW.UTF-8")
data <- read_csv ("../data/fat_ch2o_lean_fat.csv")
str(data)
names(data) <- c("body_type", "timing", "fuel", "leg_energy_exp_pct")
data$timing <- factor(data$timing, levels = c("飯前", "飯後（分泌胰島素）"))
data$timing
View(data)
data <- read_csv ("../data/fat_ch2o_lean_fat.csv")
str(data)
names(data) <- c("body_type", "timing", "fuel", "leg_energy_exp_pct")
data$timing <- factor(data$timing, levels = c("飯前", "飯後（胰島素分泌）"))
data$timing
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"), palette = "Set1")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_fill_brewer(palette = "Set1")
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"), palette = "Set1")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"), palette = palette("Set1"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"), palette = brewer.pal("Set1"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"), palette = brewer.pal(2, "Set1"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
library(RColorBrewer)
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"), palette = brewer.pal(2, "Set1"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
scale_fill_discrete(guide = guide_legend(title = "能量來源"), palette = brewer.pal(3, "Set1"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
brewer.pal(3, "Set1")
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
discrete_scale(guide = guide_legend(title = "能量來源"), palette = brewer.pal(3, "Set1"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
discrete_scale(aesthetics = fill, guide = guide_legend(title = "能量來源"), palette = brewer.pal(3, "Set1"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
discrete_scale(aesthetics = fill, scale_name = "能量來源", palette = brewer.pal(3, "Set1"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
discrete_scale(aesthetics = fill, scale_name = "能量來源", palette = brewer.pal(3, "Set1"))+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
discrete_scale(aesthetics = fill, scale_name = "能量來源", palette = brewer.pal(3, "Set1"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
discrete_scale(aesthetics = fuel, scale_name = fuel, palette = brewer.pal(3, "Set1"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
discrete_scale(aesthetics = fill, scale_name = fuel, palette = brewer.pal(3, "Set1"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
discrete_scale(aesthetics = fill, scale_name = 'fuel', palette = brewer.pal(3, "Set1"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_fill_discrete(  palette = brewer.pal(3, "Set1"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_fill_distiller(  palette = "Set1", guide = guide_legend(title = "能量來源"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('燃燒能量的比例會根據吃飯時間、\n身體胖瘦而影響',
"飯後活動時，瘦的人主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_fill_brewer( palette = "Set1", guide = guide_legend(title = "能量來源"))
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間')+
ylab('能量來源百分比') +
ggtitle('人體活動能量的來源是一個變動的比例',
"飯後活動時，瘦的人主要使用葡萄糖")+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_fill_brewer( palette = "Set1", guide = guide_legend(title = "能量來源"))
source('~/github_repos/core_train/scripts/blood_pressure.R', encoding = 'WINDOWS-1252')
ggplot(df1, aes(time, bp, colour = type))+
geom_point()+
geom_line()+
theme_tufte()+
scale_x_continuous(limits = c(0, 120))+
scale_y_continuous(limits = c(40, 200))+
scale_color_brewer(palette = "Set1")+
xlab('運動時間(秒數)')+
ylab('血壓(mmHg)') +
ggtitle('當一個人運動時間增加時，\n收縮壓會上升，舒張壓會下降',
"這個圖表是模擬的示意圖")+
guides(color=FALSE)+
annotate('text', x=60, y=170, label = '收縮壓', size = 6, family = "STHeiti")  +
annotate('text', x=60, y=90, label = '舒張壓', size = 6, family = "STHeiti") +
theme(plot.title = element_text(size = 20, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))
data <- read_csv ("../data/fat_ch2o_lean_fast.csv")
str(data)
names(data) <- c("body_type", "timing", "fuel", "leg_energy_exp_pct")
data$timing <- factor(data$timing, levels = c("飯前", "飯後（胰島素分泌）"))
data$timing
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間點')+
ylab('能量來源百分比') +
ggtitle('人體活動能量的來源是一個變動的比例')+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_fill_brewer( palette = "Set1", guide = guide_legend(title = "能量來源"))
scale_fill_brewer(palette = "Set1")
data <- read_csv ("../data/fat_ch2o_lean_fast.csv")
str(data)
names(data) <- c("body_type", "timing", "fuel", "leg_energy_exp_pct")
data$timing <- factor(data$timing, levels = c("飯前", "飯後（胰島素分泌）"))
data$timing
ggplot(data, aes(timing, leg_energy_exp_pct))+
facet_wrap(  ~ body_type, nrow = 2, strip.position = "top")+
geom_bar(position = "stack", stat = "identity", aes(fill = fuel))+
xlab('活動時間點')+
ylab('能量來源百分比') +
ggtitle('人體活動能量的來源是一個變動的比例')+
theme_tufte()+
theme(plot.title = element_text(size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0, size = 12),
text = element_text(family = "STHeiti"))+
scale_fill_brewer( palette = "Set1", guide = guide_legend(title = "能量來源"))
